{
  "properties": {
    "activities": [
      {
        "type": "InvokePipeline",
        "typeProperties": {
          "parameters": {},
          "waitOnCompletion": true,
          "workspaceId": "51061a03-089b-4baa-8771-0604308c1bd5",
          "pipelineId": "d53abc48-184d-4862-9b8d-9c7d90d8f434",
          "operationType": "InvokeFabricPipeline"
        },
        "externalReferences": {
          "connection": "3253e148-1112-475f-b7b1-0a5fc4e614bb"
        },
        "policy": {
          "timeout": "0.12:00:00",
          "retry": 0,
          "retryIntervalInSeconds": 30,
          "secureInput": false,
          "secureOutput": false
        },
        "name": "System1 Extract",
        "dependsOn": [
          {
            "activity": "Load Config",
            "dependencyConditions": [
              "Succeeded"
            ]
          }
        ]
      },
      {
        "type": "InvokePipeline",
        "typeProperties": {
          "parameters": {},
          "waitOnCompletion": true,
          "workspaceId": "51061a03-089b-4baa-8771-0604308c1bd5",
          "pipelineId": "69a15fa9-5f12-47cb-ac5b-05be8211bd53",
          "operationType": "InvokeFabricPipeline"
        },
        "externalReferences": {
          "connection": "3253e148-1112-475f-b7b1-0a5fc4e614bb"
        },
        "policy": {
          "timeout": "0.12:00:00",
          "retry": 0,
          "retryIntervalInSeconds": 30,
          "secureInput": false,
          "secureOutput": false
        },
        "name": "System2 Extract",
        "dependsOn": [
          {
            "activity": "System1 Extract",
            "dependencyConditions": [
              "Succeeded"
            ]
          }
        ]
      },
      {
        "type": "InvokePipeline",
        "typeProperties": {
          "parameters": {},
          "waitOnCompletion": true,
          "workspaceId": "51061a03-089b-4baa-8771-0604308c1bd5",
          "pipelineId": "79a6d553-e485-4e31-ba41-bbbc7ff10235",
          "operationType": "InvokeFabricPipeline"
        },
        "externalReferences": {
          "connection": "3253e148-1112-475f-b7b1-0a5fc4e614bb"
        },
        "policy": {
          "timeout": "0.12:00:00",
          "retry": 0,
          "retryIntervalInSeconds": 30,
          "secureInput": false,
          "secureOutput": false
        },
        "name": "Load Config",
        "description": "Load config files from lakehouse files",
        "dependsOn": []
      },
      {
        "type": "TridentNotebook",
        "typeProperties": {
          "notebookId": "eba3c447-1501-486c-af23-a76963564244",
          "workspaceId": "00000000-0000-0000-0000-000000000000"
        },
        "policy": {
          "timeout": "0.12:00:00",
          "retry": 0,
          "retryIntervalInSeconds": 30,
          "secureInput": false,
          "secureOutput": false
        },
        "name": "Sync Check Table",
        "dependsOn": [
          {
            "activity": "System2 Extract",
            "dependencyConditions": [
              "Succeeded"
            ]
          }
        ]
      },
      {
        "type": "SqlServerStoredProcedure",
        "typeProperties": {
          "storedProcedureName": "[audit].[EndpointSyncCheck]"
        },
        "linkedService": {
          "properties": {
            "type": "DataWarehouse",
            "typeProperties": {
              "artifactId": "46fd09fd-7b20-4a5f-9daf-7f0441e37f3e",
              "endpoint": "zkvnqmzj7bkuhj3byvnwfcpwgy-amnamum3bcvexb3raycdbda32u.datawarehouse.fabric.microsoft.com",
              "workspaceId": "51061a03-089b-4baa-8771-0604308c1bd5"
            },
            "annotations": []
          },
          "name": "Data Warehouse",
          "objectId": "46fd09fd-7b20-4a5f-9daf-7f0441e37f3e"
        },
        "policy": {
          "timeout": "0.12:00:00",
          "retry": 0,
          "retryIntervalInSeconds": 30,
          "secureInput": false,
          "secureOutput": false
        },
        "name": "Check SQL Endpoint Sync",
        "dependsOn": [
          {
            "activity": "Wait 2 minutes",
            "dependencyConditions": [
              "Succeeded"
            ]
          }
        ]
      },
      {
        "type": "Fail",
        "typeProperties": {
          "message": "SQL Endpoint Sync could not be confirmed",
          "errorCode": "100"
        },
        "name": "Fail1",
        "dependsOn": [
          {
            "activity": "Check SQL Endpoint Sync",
            "dependencyConditions": [
              "Failed"
            ]
          }
        ]
      },
      {
        "type": "TridentNotebook",
        "typeProperties": {
          "notebookId": "8fdcc531-e290-4847-be75-721642d134fe",
          "workspaceId": "00000000-0000-0000-0000-000000000000"
        },
        "policy": {
          "timeout": "0.12:00:00",
          "retry": 0,
          "retryIntervalInSeconds": 30,
          "secureInput": false,
          "secureOutput": false
        },
        "name": "Drop Sync Table",
        "dependsOn": [
          {
            "activity": "Check SQL Endpoint Sync",
            "dependencyConditions": [
              "Completed"
            ]
          }
        ]
      },
      {
        "type": "InvokePipeline",
        "typeProperties": {
          "parameters": {},
          "waitOnCompletion": true,
          "workspaceId": "51061a03-089b-4baa-8771-0604308c1bd5",
          "pipelineId": "9904b763-1520-4c6b-90ad-3c95e5bbba46",
          "operationType": "InvokeFabricPipeline"
        },
        "externalReferences": {
          "connection": "3253e148-1112-475f-b7b1-0a5fc4e614bb"
        },
        "policy": {
          "timeout": "0.12:00:00",
          "retry": 0,
          "retryIntervalInSeconds": 30,
          "secureInput": false,
          "secureOutput": false
        },
        "name": "Refresh Warehouse",
        "dependsOn": [
          {
            "activity": "Check SQL Endpoint Sync",
            "dependencyConditions": [
              "Succeeded"
            ]
          }
        ]
      },
      {
        "type": "Wait",
        "typeProperties": {
          "waitTimeInSeconds": 120
        },
        "name": "Wait 2 minutes",
        "dependsOn": [
          {
            "activity": "Sync Check Table",
            "dependencyConditions": [
              "Succeeded"
            ]
          }
        ]
      },
      {
        "type": "InvokePipeline",
        "typeProperties": {
          "parameters": {},
          "waitOnCompletion": true,
          "workspaceId": "51061a03-089b-4baa-8771-0604308c1bd5",
          "pipelineId": "a9f8e1ab-1082-4788-a517-66aa10429f22",
          "operationType": "InvokeFabricPipeline"
        },
        "externalReferences": {
          "connection": "3253e148-1112-475f-b7b1-0a5fc4e614bb"
        },
        "policy": {
          "timeout": "0.12:00:00",
          "retry": 0,
          "retryIntervalInSeconds": 30,
          "secureInput": false,
          "secureOutput": false
        },
        "name": "Refresh Semantic Models",
        "dependsOn": [
          {
            "activity": "Refresh Warehouse",
            "dependencyConditions": [
              "Succeeded"
            ]
          }
        ]
      }
    ]
  }
}